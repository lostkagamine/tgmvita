pieces = {
    I = {
        {{0, 0, 0, 0},
         {1, 1, 1, 1},
         {0, 0, 0, 0},
         {0, 0, 0, 0}},
        {{0, 0, 1, 0},
         {0, 0, 1, 0},
         {0, 0, 1, 0},
         {0, 0, 1, 0}},
        {{0, 0, 0, 0},
         {0, 0, 0, 0},
         {1, 1, 1, 1},
         {0, 0, 0, 0}},
        {{0, 1, 0, 0},
         {0, 1, 0, 0},
         {0, 1, 0, 0},
         {0, 1, 0, 0}}
    },
    J = {
        {{1, 0, 0},
        {1, 1, 1},
        {0, 0, 0}},
        {{0, 1, 1},
        {0, 1, 0},
        {0, 1, 0}},
        {{0, 0, 0},
        {1, 1, 1},
        {0, 0, 1}},
        {{0, 1, 0},
        {0, 1, 0},
        {1, 1, 0}}
    },
    L = {
        {{0, 0, 1},
        {1, 1, 1},
        {0, 0, 0}},
        {{0, 1, 0},
        {0, 1, 0},
        {0, 1, 1}},
        {{0, 0, 0},
        {1, 1, 1},
        {1, 0, 0}},
        {{1, 1, 0},
        {0, 1, 0},
        {0, 1, 0}}
    },
    O = {
        {{1,1},
         {1,1}}
    },
    S = {
        {{0, 1, 1},
        {1, 1, 0},
        {0, 0, 0}},
        {{0, 1, 0},
        {0, 1, 1},
        {0, 0, 1}},
        {{0, 0, 0},
        {0, 1, 1},
        {1, 1, 0}},
        {{1, 0, 0},
        {1, 1, 0},
        {0, 1, 0}}
    },
    T = {
        {{0, 1, 0},
         {1, 1, 1},
         {0, 0, 0}},
        {{0, 1, 0},
         {0, 1, 1},
         {0, 1, 0}},
        {{0, 0, 0},
         {1, 1, 1},
         {0, 1, 0}},
        {{0, 1, 0},
         {1, 1, 0},
         {0, 1, 0}}
    },
    Z = {
        {{1, 1, 0},
        {0, 1, 1},
        {0, 0, 0}},
        {{0, 0, 1},
        {0, 1, 1},
        {0, 1, 0}},
        {{0, 0, 0},
        {1, 1, 0},
        {0, 1, 1}},
        {{0, 1, 0},
        {1, 1, 0},
        {1, 0, 0}}
    }
}

local JLSZT = {
    ZO = { {0, 0},{-1, 0},{-1, 1},{0, -2},{-1, -2} },
    OZ = { {0, 0},{1, 0},{1, -1},{0, 2},{1, 2} },
    OT = { {0, 0},{1, 0},{1, -1},{0, 2},{1, 2} },
    TO = { {0, 0},{-1, 0},{-1, 1},{0, -2},{-1, -2} },
    TH = { {0, 0},{1, 0},{1, 1},{0, -2},{1, -2} },
    HT = { {0, 0},{-1, 0},{-1, -1},{0, 2},{-1, 2} },
    HZ = { {0, 0},{-1, 0},{-1, -1},{0, 2},{-1, 2} },
    ZH = { {0, 0},{1, 0},{1, 1},{0, -2},{1, -2} }
}
local I = {
    ZO = { {0, 0},{-2, 0},{1,  0},{-2, -1},{1,   2} },
    OZ = { {0, 0},{2,  0},{-1, 0},{2,   1},{-1, -2} },
    OT = { {0, 0},{-1, 0},{2, 0},{-1,  2},{2,  -1} },
    TO = { {0, 0},{1,  0},{-2, 0},{1,  -2},{-2,  1} },
    TH = { {0, 0},{2,  0},{-1, 0},{2,   1},{-1, -2} },
    HT = { {0, 0},{-2, 0},{1,  0},{-2, -1},{1,   2} },
    HZ = { {0, 0},{1,  0},{-2, 0},{1,  -2},{-2,  1} },
    ZH ={ {0, 0},{-1, 0},{2,  0},{-1,  2},{2,  -1} }
}
local O = { ZZ = {{0,0}} }

local names = { -- Lua pls
    "Z", "O", "T", "H"
}

piececolours = {
    I = newColour(55, 255, 255),
    O = newColour(255, 255, 55),
    J = newColour(55, 55, 255),
    Z = newColour(255, 55, 55),
    S = newColour(55, 255, 55),
    L = newColour(255, 155, 55),
    T = newColour(155, 55, 255),
}

function game_wallkick(gamestate, piece, a, b)
    if a == 0 then
        a = 4
    end
    if b == 0 then
        b = 4
    end
    if a == 5 then
        a = 1
    end
    if b == 5 then
        b = 1
    end
    local ax, ay = 0
    local offset = JLSZT
    if gamestate.piece == "I" then
        offset = I
    end
    if gamestate.piece == "O" then
        offset = O
    end
    local kicks = offset[names[a] .. names[b]]
    for _, kick in ipairs(kicks or {{0,0}}) do
        ax = gamestate.x + kick[1]
        ay = gamestate.y + (kick[2] * -1)
        if not gamestate:isColliding(pieces[gamestate.piece][b], ax, ay) then
            return false, kick[1], kick[2] * -1
        end
    end
    return true, 0, 0
end

WORLD_RULE = true
REVERSE_ROTATIONS = true